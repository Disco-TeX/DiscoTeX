<!DOCTYPE html>
<html lang="en">
<head>
<title>DiscoTeX Compiler</title>

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta charset="UTF-8" />

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

<link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

<!-- MathJax -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- DiscoTeX -->
<script type="text/javascript" src="src/compiler/catcode.js"></script>
<script type="text/javascript" src="src/compiler/Stream.js"></script>
<script type="text/javascript" src="src/compiler/State.js"></script>
<script type="text/javascript" src="src/compiler/Parser.js"></script>
<script type="text/javascript" src="src/compiler/TeX.js"></script>
<script type="text/javascript" src="src/compiler/DiscoTeX.js"></script>
<script type="text/javascript" src="src/compiler/LaTeX.js"></script>


<script>
window.onload = function(){
    var activeLink = 'in';

    var clickLink = function(newLink){
//        console.log(document.getElementById(activeLink + '-link').className.split(/\s+/));
//        $(activeLink + '-link').removeClass('active');
//        activeLink = newLink;
//        $(activeLink + '-link').addClass('active');
//        console.log(document.getElementById(activeLink + '-link').className.split(/\s+/));

    }

    $('#in-link a').click(function (e){
            e.preventDefault();
            clickLink('in');
            $('#content').html('input');
            });
    $('#err-link a').click(function (e){
            e.preventDefault();
            clickLink('err');
            $('#content').html('error');
            });
    $('#out-link a').click(function (e){
            e.preventDefault();
            clickLink('out');
            $('#content').html('output');
            });
}

compile = function(file){
    $.ajaxSetup({ cache: false });

    $.ajax({
type: 'GET',
async: true,
timeout: 5000,
url: file,
success: function(data, textStatus, request){
var start = new Date().getTime();
var modDate  = new Date(request.getResponseHeader('Last-Modified'));
var parser = new DiscoTeX.Parser(data, modDate);
var html = parser.parse();
var end = new Date().getTime();

var ewlog = parser.getErrorLog();
ewlog = ewlog.concat(parser.getWarningLog());

//ewlog.concat(parser.getWarningLog());

ewlog.sort(function(x, y){ return x.line > y.line; });

$('#err-link span.badge').text(ewlog.length !== 0 ? ewlog.length : '');
$('#err-tab').text(ewlog);
var ewlogString = '';
ewlog.forEach(function(el){
        ewlogString += '<tr class="' + el.type + '"><td align="right"><strong>' + el.line + '</strong></td><td>' + el.message + '</td></tr>';
    });

ewlogString = '<br/><div class="row"><div class="col-md-10 col-md-offset-1"><table class="table table-hover"><thead><th>Line:</th><th>Message:</th></thead></thead>' + ewlogString + '</table></div></div>';
$('#err-tab').html(ewlogString);

$('#output').text(html);


$('#execTime').text('Compilation time: ' + ((end - start) / 1000) + ' seconds');
}

});
}
</script>
<style type="text/css">
body{
    padding-top: 70px;
}

</style>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="htpps://disco-tex.github.io/DiscoTeX">\(\mathrm{Disco\!\TeX}\)</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
          <li id="in-link"><a href="">Input</a></li>
          <li id="err-link"><a href="">Errors/Warnings</a></li>
          <li id="out-link"><a href="">Output</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<div class="container-fluid">
    <div id="content"></div>
</div>

<!--<textarea id="output" rows = "20", cols="40"></textarea>

</body>
</html>
